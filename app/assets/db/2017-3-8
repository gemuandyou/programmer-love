{
  "noteData": "<pre><pre><pre><pre><span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h1</span>-SpringBoot的一些用法\n\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h2</span>-动态配置@Scheduled的参数\n从application.properties的SpringBoot配置文件中动态配置Scheduled的参数。\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@ol</span>-(#写好需要定时执行的任务方法 #创建一个类实现SchedulingConfigurer接口，并将此类用@EnableScheduling和@Configuration修饰)<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@tab</span>-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@pre</span>-@[<pre style=\"font-family: Monaco,'Lucida Console',monospace;\"><div style=\"font-family: fantasy;color: thistle; user-select: none;\">java</div><div style=\"background-color: #f1f1f1\">@Component\r\n<span style=\"font-weight: bold; color: dodgerblue\">public</span> <span style=\"font-weight: bold; color: dodgerblue\">class</span> ScheduledTask {\r\n\t<span style=\"font-weight: bold; color: dodgerblue\">public</span> <span style=\"font-weight: bold; color: dodgerblue\">void</span> monitorApi() {\r\n\t\t// to <span style=\"font-weight: bold; color: dodgerblue\">do</span> something\r\n\t}\r\n};</div></pre>]@ <span contenteditable=\"false\" style=\"color: rgb(0, 192, 255);\">@pre</span>-@[<pre style=\"font-family: Monaco,'Lucida Console',monospace;\"><div style=\"font-family: fantasy;color: thistle; user-select: none;\">java</div><div style=\"background-color: #f1f1f1;\">@Configuration\r\n@EnableScheduling\r\n<span style=\"font-weight: bold; color: dodgerblue\">public</span> <span style=\"font-weight: bold; color: dodgerblue\">class</span> ScheduledDynamicTask <span style=\"font-weight: bold; color: dodgerblue\">implements</span> SchedulingConfigurer {\r\n\r\n    @Value(&quot;${schedule-fixed-rate}&quot;)\r\n    <span style=\"font-weight: bold; color: dodgerblue\">private</span> <span style=\"font-weight: bold; color: dodgerblue\">Integer</span> fixedRate;\r\n\r\n    @Autowired\r\n    ScheduledTask scheduledTask;\r\n\r\n    @Override\r\n    <span style=\"font-weight: bold; color: dodgerblue\">public</span> <span style=\"font-weight: bold; color: dodgerblue\">void</span> configureTasks(ScheduledTaskRegistrar scheduledTaskRegistrar) {\r\n        scheduledTaskRegistrar.addFixedRateTask(<span style=\"font-weight: bold; color: dodgerblue\">new</span> Runnable() {\r\n            @Override\r\n            <span style=\"font-weight: bold; color: dodgerblue\">public</span> <span style=\"font-weight: bold; color: dodgerblue\">void</span> run() {\r\n                scheduledTask.monitorApi();\r\n            }\r\n        }, fixedRate.longValue());\r\n    }\r\n}</div></pre>]@ \napplication.properties内容如下：<span contenteditable=\"false\" style=\"color: rgb(0, 192, 255);\">@pre</span>-@[<pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:'宋体';font-size:10.5pt;\"><span style=\"color:#cc7832;\">schedule-fixed-rate</span><span style=\"color:#808080;\">=</span><span style=\"color:#6a8759;\">5000</span></pre>]@ \n\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h2</span>-事务的配置\nspringboot的事务配置很简单，只要在对应的service上添加<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>@Transaction  就可以了。\n如果项目比较大，需要多个事务管理器，那么就需要在<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>Application  启动类中实现<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>TransactionManagementConfigurer  类，同时将该Application加上注解<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>@EnableTransactionManagement 。配置如下：\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-java-@[@EnableTransactionManagement\n@SpringBootApplication\npublic class Application implements TransactionManagementConfigurer {\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run( Application.class, args);\n\t}\n\n\t@Bean(name = \"txManager\")\n\tpublic PlatformTransactionManager txManager(DataSource dataSource) {\n\t\treturn new DataSourceTransactionManager(dataSource);\n\t}\n\n\t@Resource(name = \"txManager\")\n\tprivate PlatformTransactionManager txManager;\n\n\t@Override\n\tpublic PlatformTransactionManager annotationDrivenTransactionManager() {\n\t\treturn txManager;\n\t}\n}]@ 在使用<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>@Transaction  的时候加上事务管理的<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@b</span>-name 就可以了。如：<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"edit-span\">@code</span>-java-@[@Transaction(value=\"txManager\")]@  \\<br></pre></pre></pre></pre>",
  "noteName": "2017-3-8"
}