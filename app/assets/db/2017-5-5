{
  "noteData": "<pre><span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h2</span>-FastDFS在ubuntu上的安装过程\n参考<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@url</span>-[http://blog.mayongfa.cn/192.html]分布式文件系统-FastDFS在CentOS下配置安装部署    、 <span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@url</span>-[http://www.cnblogs.com/mafly/archive/2016/11/09/fastdfs_nginx.html]分布式文件系统-FastDFS配置Nginx模块及上传测试 <span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@hr</span>- \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h4</span>-安装libfastcommon\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; wget https://github.com/happyfish100/libfastcommon/archive/V1.0.7.tar.gz\n&gt; tar zxvf V1.0.7.tar.gz]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-result-@[<span contenteditable=\"false\" style=\"color: rgb(0, 192, 255);\">@img</span>-[app/assets/db/img/1493952037611.png] ]@ \\\n进入<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>libfastcommon-1.0.7  目录编译、安装。若没有安装gcc编译环境需要安装之后进行编译。\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-安装编译环境-@[&gt; apt-get install build-essential]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-编译libfastcommon-@[&gt; ./make.sh]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-安装libfastcommon-@[&gt; ./make.sh install]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h4</span>-安装FastDFS\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; wget https://github.com/happyfish100/fastdfs/archive/V5.05.tar.gz\n&gt; tar zxvf V5.05.tar.gz]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-result-@[<span contenteditable=\"false\" style=\"color: rgb(0, 192, 255);\">@img</span>-[app/assets/db/img/1493953163314.png] ]@ \\\n进入fastdfs-5.05目录。\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-编译fastdfs-@[&gt; ./make.sh]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-安装fastdfs-@[&gt; ./make.sh install]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h4</span>-配置Tracker服务\n一些fdfs的配置文件示例都在<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>/etc/fdfs/  目录下。要配置需要拷贝出一份来进行自定义。\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; cp client.conf.sample client.conf\n&gt; cp storage.conf.sample storage.conf\n&gt; cp tracker.conf.sample tracker.conf]@ \\\n好了，现在来修改一下tracker.conf的内容。\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[...\n# the base path to store data and log files\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-red-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>base_path=/home/gemu/fastdfs \n...\n# HTTP port on this tracker server\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-red-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>http.server_port=80 ]@ \\\n配置完后，需要创建一下文件夹<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>mkdir&amp;nbsp;/home/gemu/fastdfs  ，启动Tracker服务。\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; /usr/bin/fdfs_trackerd /etc/fdfs/tracker.conf start]@ \\\n很不愉快的事情发生了。<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-error-@[/usr/bin/fdfs_trackerd: error while loading shared libraries: libfastcommon.so: cannot open shared object file: No such file or directory]@ \\\n原因是在<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>/usr/lib/  目录下没有libfastcommon.so文件。而这个文件在<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>/usr/lib64/  下是存在的，所以就复制过来就可以了。<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; cp /usr/lib64/libfastcommon.so /usr/lib/]@\n再重新启动tracker就可以了。\n使用如下命令查看端口情况：<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; netstat -nlp | grep fdfs]@  \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-result-@[root@ubuntu:/etc/fdfs# netstat -nlp | grep fdfs\ntcp        0      0 0.0.0.0:22122           0.0.0.0:*               LISTEN      62539/fdfs_trackerd]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h4</span>-配置Storage服务\n修改storage.conf内容。\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[...\n# the base path to store data and log files\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-red-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>base_path=/home/gemu/fastdfs/storage \n...\n# the paths must be exist\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-red-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>store_path0=/home/gemu/fastdfs/storage \n...\n# tracker_server can ocur more than once, and tracker_server format is\n#  &amp;quot;host:port&amp;quot;, host can be hostname or ip address\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-red-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>tracker_server=192.168.202.131:22122 \n...]@ \\\n别忘了创建<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>/home/gemu/fastdfs/storage  目录。\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-result-@[root@ubuntu:/etc/fdfs# netstat -nlp | grep fdfs\ntcp        0      0 0.0.0.0:22122           0.0.0.0:*               LISTEN      62539/fdfs_trackerd\ntcp        0      0 0.0.0.0:23000           0.0.0.0:*               LISTEN      62577/fdfs_storaged]@ \nTracker和Storage服务已经启动了，他们是否能进行通讯使用如下命令查看一下：<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; /usr/bin/fdfs_monitor /etc/fdfs/storage.conf]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h4</span>-配置client.conf\n修改<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>/etc/fdfs/  下的client.conf配置文件。\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[...\n# the base path to store log files\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-red-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>base_path=/home/gemu/fastdfs \n\n# tracker_server can ocur more than once, and tracker_server format is\n#  &amp;quot;host:port&amp;quot;, host can be hostname or ip address\n@fc-red-&gt;tracker_server=192.168.202.131:22122 \n...]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h4</span>-上传文件测试\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; /usr/bin/fdfs_test /etc/fdfs/client.conf upload ./assets/dota_sf.jpg]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-线上上传-@[/usr/bin/fdfs_upload_file /etc/fdfs/client.conf /home/gemu/assets/dota_sf.jpg]@\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-red-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>目前还只能上传，如果要浏览的话需要借助Nginx服务器来访问。 \n\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h4</span>-安装Nginx和fastdfs-nginx-module插件\nubuntu上安装nginx的时候需要安装3个依赖库（其他Linux上不知道要不要），<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>zlib <span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>pcre <span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>openssl 。\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@b</span>-查看是否安装 <span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; dpkg -l | grep zlib]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@b</span>-安装zlib、pcre、openssl依赖 <span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; apt-get install zlib1g-dev\n&gt; apt-get install libpcre3 libpcre3-dev\n&gt; apt-get install openssl libssl-dev]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h5</span>-下载nginx和fastdfs-nginx-module\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; wget -c https://nginx.org/download/nginx-1.10.1.tar.gz\n&gt; wget https://github.com/happyfish100/fastdfs-nginx-module/archive/master.zip]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h5</span>-解压nginx和fastdfs-nginx-module\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; tar -zxvf nginx-1.10.1.tar.gz\n&gt; unzip master.zip]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h5</span>-配置nginx安装，加入fastdfs-nginx-module\n进入到nginx-1.10.1目录\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[./configure \\\n--prefix=/usr/local/nginx \\\n--pid-path=/var/local/nginx/nginx.pid \\\n--lock-path=/var/lock/nginx/nginx.lock \\\n--error-log-path=/var/log/nginx/error.log \\\n--http-log-path=/var/log/nginx/access.log \\\n--with-http_gzip_static_module \\\n--http-client-body-temp-path=/var/temp/nginx/client \\\n--http-proxy-temp-path=/var/temp/nginx/proxy \\\n--http-fastcgi-temp-path=/var/temp/nginx/fastcgi \\\n--http-uwsgi-temp-path=/var/temp/nginx/uwsgi \\\n--http-scgi-temp-path=/var/temp/nginx/scgi \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-red-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>--add-module=/home/gemu/fastdfs-nginx-module/src ]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h5</span>-安装nginx\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-编译-@[&gt; make]@ <span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-安装-@[&gt; make install]@ \n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@b</span>-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-darkgreen-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>这时可以试着使用nginx查看它的版本信息.。  <span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; /usr/local/nginx/sbin/nginx -V]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-@fc-red-&gt;异常-@[error while loading shared libraries: libfdfsclient.so: cannot open shared object file: No such file or directory]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"edit-span\">@code</span>-解决办法就是把lib64中的找不到的文件拷贝到lib中-@[&gt; cp /usr/lib64/libfdfsclient.so /usr/lib]@\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h5</span>-编辑fastdfs-nginx模块配置文件\n复制fastdfs-nginx-module中的mod_fastdfs.conf到<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>/etc/fdfs  中，并进行修改。\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; cp /home/gemu/fastdfs-nginx-module/src/mod_fastdfs.conf /etc/fdfs]@ \\\n修改<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>/etc/fdfs/mod_fastdfs.conf  ：\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[# FastDFS tracker_server can ocur more than once, and tracker_server format is\n#  &amp;quot;host:port&amp;quot;, host can be hostname or ip address\n# valid only when load_fdfs_parameters_from_tracker is true\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-red-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>tracker_server=192.168.202.131:22122 \n\n# if the url / uri including the group name\n# set to false when uri like /M00/00/00/xxx\n# set to true when uri like ${group_name}/M00/00/00/xxx, such as group1/M00/xxx\n# default value is false\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-red-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>url_have_group_name=true \n\n# store_path#, based 0, if store_path0 not exists, it's value is base_path\n# the paths must be exist\n# must same as storage.conf \n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fc</span>-red-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>store_path0=/home/gemu/fastdfs/storage \n#store_path1=/home/gemu/fastdfs1]@ \n然后把<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>fastdfs-5.05  中的配置拷到<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>/etc/fdfs  中。<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>--@[&gt; cp anti-steal.jpg http.conf mime.types /etc/fdfs/]@ \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@h5</span>-配置Nginx\n编辑<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-yellow-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>/usr/local/nginx/conf/nginx.conf  \n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-加入-@[location /group1/M00 {\n    root /home/gemu/fastdfs/storage/;\n    ngx_fastdfs_module;\n}]@ \\\n这时我们启动nginx， <span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@fbc</span>-gray-<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\">&gt;</span>/usr/local/nginx/sbin/nginx  会打印出fastdsf模块的pid。<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-result-@[root@ubuntu:/home/gemu# /usr/local/nginx/sbin/nginx \nngx_http_fastdfs_set pid=8172]@ \\\n上传文件后，会得到一个地址，可以直接在浏览器中访问。\n\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-@fc-red-&gt;异常-@[error while loading shared libraries: libfastcommon.so: cannot open shared object file: No such file or directory]@  \\\n<span style=\"font-style: italic; color: #00c0ff;\" contenteditable=\"false\" class=\"\">@code</span>-解决办法就是把lib64中的找不到的文件拷贝到lib中-@[cp /usr/lib64/libfastcommon.so /usr/lib/]@\n\n</pre>",
  "noteName": "2017-5-5"
}